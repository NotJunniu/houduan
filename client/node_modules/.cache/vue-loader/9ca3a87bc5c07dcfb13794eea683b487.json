{"remainingRequest":"D:\\实训2\\springboot和vue旅游系统蓝色3322\\client\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\实训2\\springboot和vue旅游系统蓝色3322\\client\\src\\components\\select\\select-list.vue?vue&type=script&lang=js","dependencies":[{"path":"D:\\实训2\\springboot和vue旅游系统蓝色3322\\client\\src\\components\\select\\select-list.vue","mtime":1619169822000},{"path":"D:\\实训2\\springboot和vue旅游系统蓝色3322\\client\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1755258878262},{"path":"D:\\实训2\\springboot和vue旅游系统蓝色3322\\client\\node_modules\\babel-loader\\lib\\index.js","mtime":1755258879229},{"path":"D:\\实训2\\springboot和vue旅游系统蓝色3322\\client\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1755258878262},{"path":"D:\\实训2\\springboot和vue旅游系统蓝色3322\\client\\node_modules\\vue-loader\\lib\\index.js","mtime":1755258879809}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:DQogICAgaW1wb3J0IGFwaSBmcm9tICJAL2FwaSI7DQogICAgaW1wb3J0IHsgZW1wdHksIGlzQXJyYXkgLGlzT2JqZWN0fSBmcm9tICJAL3V0aWxzL2V4dGVuZCI7DQogICAgaW1wb3J0IHtmaW5kT2JqZWN0fSBmcm9tICJAL3V0aWxzL3V0aWxzIjsNCg0KICAgIGV4cG9ydCBkZWZhdWx0IHsNCiAgICAgICAgbmFtZTogImUtc2VsZWN0LWxpc3QiLA0KICAgICAgICBkYXRhKCkgew0KICAgICAgICAgICAgcmV0dXJuIHsNCiAgICAgICAgICAgICAgICBsaXN0OltdLA0KICAgICAgICAgICAgICAgIHNlYXJjaE1zZzp7DQogICAgICAgICAgICAgICAgICAgIGtleXdvcmQ6JycNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgIH0sDQogICAgICAgIHByb3BzOnsNCiAgICAgICAgICAgIHZhbHVlOltTdHJpbmcsTnVtYmVyXSwNCiAgICAgICAgICAgIG1vZGVsOnsNCiAgICAgICAgICAgICAgICB0eXBlOk9iamVjdCwNCiAgICAgICAgICAgICAgICByZXF1aXJlZDp0cnVlDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgbW9kdWxlOnsNCiAgICAgICAgICAgICAgICB0eXBlOlN0cmluZywNCiAgICAgICAgICAgICAgICByZXF1aXJlZDogdHJ1ZQ0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgIHNlbGVjdFVwZGF0ZTpbU3RyaW5nLEFycmF5XSwNCiAgICAgICAgICAgIHNlYXJjaFVwZGF0ZTp7DQogICAgICAgICAgICAgICAgdHlwZTpbU3RyaW5nLEFycmF5XSwNCiAgICAgICAgICAgICAgICBkZWZhdWx0OicnDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgc2hvd0ZpZWxkOnsNCiAgICAgICAgICAgICAgICB0eXBlOltTdHJpbmcsQXJyYXldDQogICAgICAgICAgICB9DQogICAgICAgIH0sDQogICAgICAgIHdhdGNoOiB7DQogICAgICAgICAgICB2YWx1ZSh2YWwpew0KICAgICAgICAgICAgICAgIHRoaXMuc2VsZWN0T3B0aW9uKHZhbCk7DQogICAgICAgICAgICB9DQogICAgICAgIH0sDQogICAgICAgIGNvbXB1dGVkOiB7DQogICAgICAgIH0sDQogICAgICAgIG1ldGhvZHM6IHsNCiAgICAgICAgICAgIHNlbGVjdE9wdGlvbih2YWx1ZSl7DQogICAgICAgICAgICAgICAgdmFyIHYgPSBmaW5kT2JqZWN0KHRoaXMubGlzdCAsIHI9PnIuaWQgPT0gdmFsdWUgKTsNCiAgICAgICAgICAgICAgICBpZiggdiAhPT0gZmFsc2UgKXsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy51cGRhdGVNb2RlbCh2KTsNCiAgICAgICAgICAgICAgICB9ZWxzZXsNCiAgICAgICAgICAgICAgICAgICAgaWYodmFsdWUgPT0gMCl7DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnVwZGF0ZU1vZGVsKHt9KTsNCiAgICAgICAgICAgICAgICAgICAgfWVsc2V7DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLiRwb3N0KGFwaS5zZWFyY2gudGFibGUgLCB7aWQ6dmFsdWV9KS50aGVuKHJlcz0+ew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKCFlbXB0eShyZXMpICYmIGlzT2JqZWN0KHJlcykpew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmxpc3QucHVzaChyZXMpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnVwZGF0ZU1vZGVsKHJlcyk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfSkuY2F0Y2goZXJyPT57DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy4kbWVzc2FnZS5lcnJvcihlcnIubWVzc2FnZSkNCiAgICAgICAgICAgICAgICAgICAgICAgIH0pDQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgdXBkYXRlTW9kZWwodil7DQogICAgICAgICAgICAgICAgdmFyIGZpZWxkID0gaXNBcnJheSh0aGlzLnNlbGVjdFVwZGF0ZSkgPyB0aGlzLnNlbGVjdFVwZGF0ZSA6IHRoaXMuc2VsZWN0VXBkYXRlLnNwbGl0KCcsJyk7DQogICAgICAgICAgICAgICAgZm9yICh2YXIgaT0wO2k8ZmllbGQubGVuZ3RoO2krKykNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgIHZhciBmID0gZmllbGRbaV07DQogICAgICAgICAgICAgICAgICAgIGlmKCBmICl7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZGVmID0gLyheWzAtOV0rJCkvLnRlc3QodGhpcy5tb2RlbFtmXSkgJiYgdGhpcy5tb2RlbFtmXS5sZW5ndGg8MTEgPyAwIDogJyc7DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm1vZGVsW2ZdID0gdltmXSAhPT0gdW5kZWZpbmVkID8gdltmXSA6IGRlZjsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICBnZXRMYWJlbCh2KXsNCiAgICAgICAgICAgICAgICB2YXIgcmVzdWx0ID0gJyc7DQogICAgICAgICAgICAgICAgdmFyIGZpZWxkID0gW107DQogICAgICAgICAgICAgICAgaWYodGhpcy5zaG93RmllbGQpew0KICAgICAgICAgICAgICAgICAgICBmaWVsZCA9IGlzQXJyYXkodGhpcy5zaG93RmllbGQpID8gdGhpcy5zaG93RmllbGQgOiB0aGlzLnNob3dGaWVsZC5zcGxpdCgnLCcpLmZpbHRlcih2PT4hZW1wdHkodikpDQogICAgICAgICAgICAgICAgfWVsc2V7DQogICAgICAgICAgICAgICAgICAgIGZpZWxkID0gaXNBcnJheSh0aGlzLnNlbGVjdFVwZGF0ZSkgPyB0aGlzLnNlbGVjdFVwZGF0ZSA6IHRoaXMuc2VsZWN0VXBkYXRlLnNwbGl0KCcsJykNCiAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICAvL3ZhciBmaWVsZCA9IGlzQXJyYXkodGhpcy5zZWxlY3RVcGRhdGUpID8gdGhpcy5zZWxlY3RVcGRhdGUgOiB0aGlzLnNlbGVjdFVwZGF0ZS5zcGxpdCgnLCcpDQoNCiAgICAgICAgICAgICAgICBmb3IgKHZhciBpPTA7aTxmaWVsZC5sZW5ndGg7aSsrKQ0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGYgPSBmaWVsZFtpXTsNCiAgICAgICAgICAgICAgICAgICAgaWYoZiAmJiB2W2ZdKXsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdCArPSB2W2ZdKycgLSAnOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIHJldHVybiByZXN1bHQ7DQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgc2VhcmNoVGFibGUoaXNFbWl0KXsNCiAgICAgICAgICAgICAgICB2YXIgd2hlcmUgPSB7fTsNCiAgICAgICAgICAgICAgICB2YXIgZmllbGQgPSBpc0FycmF5KHRoaXMuc2VsZWN0VXBkYXRlKSA/IHRoaXMuc2VsZWN0VXBkYXRlIDogdGhpcy5zZWxlY3RVcGRhdGUuc3BsaXQoJywnKQ0KICAgICAgICAgICAgICAgIHZhciBleHQgICA9IGlzQXJyYXkodGhpcy5zZWFyY2hVcGRhdGUpID8gdGhpcy5zZWFyY2hVcGRhdGUgOiB0aGlzLnNlYXJjaFVwZGF0ZS5zcGxpdCgnLCcpDQogICAgICAgICAgICAgICAgdmFyIGZzID0gZmllbGQuY29uY2F0KGV4dCkuZmlsdGVyKGY9PmYhPScnKTsNCiAgICAgICAgICAgICAgICB3aGVyZVtmcy5qb2luKCd8JyldID0gWyAnbGlrZScgLCAnJScrdGhpcy5zZWFyY2hNc2cua2V5d29yZCsnJSddOw0KICAgICAgICAgICAgICAgIHRoaXMuJGVtaXQoJ3VwZGF0ZS13aGVyZScgLCB3aGVyZSk7DQogICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy4kcG9zdChhcGkuc2VhcmNoLnNlbGVjdCAsIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRhYmxlOnRoaXMubW9kdWxlLA0KICAgICAgICAgICAgICAgICAgICAgICAgd2hlcmU6SlNPTi5zdHJpbmdpZnkod2hlcmUpDQogICAgICAgICAgICAgICAgICAgIH0pLnRoZW4ocmVzPT57DQogICAgICAgICAgICAgICAgICAgICAgICBpZihpc0VtaXQpew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuJGVtaXQoJ2lucHV0JyAsIDApOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5saXN0ID0gcmVzOw0KICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShyZXMpDQogICAgICAgICAgICAgICAgICAgIH0pLmNhdGNoKGVycj0+ew0KICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVyci5tZXNzYWdlKTsNCiAgICAgICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICB9DQogICAgICAgIH0sDQogICAgICAgIGNyZWF0ZWQoKSB7DQogICAgICAgICAgICB0aGlzLnNlYXJjaFRhYmxlKCkudGhlbihyZXM9PnsNCiAgICAgICAgICAgICAgICBpZih0aGlzLnZhbHVlKXsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5zZWxlY3RPcHRpb24odGhpcy52YWx1ZSkNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9KTsNCiAgICAgICAgfSwNCiAgICAgICAgbW91bnRlZCgpIHsNCiAgICAgICAgfSwNCiAgICAgICAgZGVzdHJveWVkKCkgew0KICAgICAgICB9DQogICAgfQ0K"},{"version":3,"sources":["select-list.vue"],"names":[],"mappings":";AAiDA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"select-list.vue","sourceRoot":"src/components/select","sourcesContent":["<template>\r\n    <div class=\"e-select-list\">\r\n        <div class=\"select-update\">\r\n            <div>\r\n                <el-select @change=\"$emit('input' , $event)\" :value=\"value\" filterable>\r\n                    <el-option :value=\"0\" label=\"请选择\"></el-option>\r\n                    <el-option :value=\"v.id\" :label=\"getLabel(v)\" v-for=\"v in list\" :key=\"v.id\"></el-option>\r\n                </el-select>\r\n            </div>\r\n            <div>\r\n                关键词：\r\n                <el-input style=\"width: 150px\" v-model=\"searchMsg.keyword\" />\r\n            </div>\r\n            <div>\r\n                <slot name=\"search\"></slot>\r\n            </div>\r\n            <!--<div class=\"search-list\" ref=\"search\">\r\n            </div>-->\r\n            <div class=\"search-btn\">\r\n                <el-button icon=\"el-icon-search\" @click=\"searchTable(true)\">\r\n                    搜索\r\n                </el-button>\r\n            </div>\r\n        </div>\r\n        <div class=\"\" v-if=\"value!=0\">\r\n            <slot>\r\n            </slot>\r\n        </div>\r\n    </div>\r\n</template>\r\n<style type=\"text/scss\" lang=\"scss\">\r\n.e-select-list{\r\n    .select-update{\r\n        display: flex;\r\n        flex-wrap:wrap;\r\n        >div{\r\n            margin-right: 10px;\r\n        }\r\n        >div:last-child{\r\n            margin-right: 0px;\r\n        }\r\n\r\n    }\r\n    .search-list{\r\n\r\n    }\r\n}\r\n</style>\r\n<script>\r\n    import api from \"@/api\";\r\n    import { empty, isArray ,isObject} from \"@/utils/extend\";\r\n    import {findObject} from \"@/utils/utils\";\r\n\r\n    export default {\r\n        name: \"e-select-list\",\r\n        data() {\r\n            return {\r\n                list:[],\r\n                searchMsg:{\r\n                    keyword:''\r\n                }\r\n            }\r\n        },\r\n        props:{\r\n            value:[String,Number],\r\n            model:{\r\n                type:Object,\r\n                required:true\r\n            },\r\n            module:{\r\n                type:String,\r\n                required: true\r\n            },\r\n            selectUpdate:[String,Array],\r\n            searchUpdate:{\r\n                type:[String,Array],\r\n                default:''\r\n            },\r\n            showField:{\r\n                type:[String,Array]\r\n            }\r\n        },\r\n        watch: {\r\n            value(val){\r\n                this.selectOption(val);\r\n            }\r\n        },\r\n        computed: {\r\n        },\r\n        methods: {\r\n            selectOption(value){\r\n                var v = findObject(this.list , r=>r.id == value );\r\n                if( v !== false ){\r\n                    this.updateModel(v);\r\n                }else{\r\n                    if(value == 0){\r\n                        this.updateModel({});\r\n                    }else{\r\n                        this.$post(api.search.table , {id:value}).then(res=>{\r\n                            if(!empty(res) && isObject(res)){\r\n                                this.list.push(res);\r\n                                this.updateModel(res);\r\n                            }\r\n                        }).catch(err=>{\r\n                            this.$message.error(err.message)\r\n                        })\r\n                    }\r\n                }\r\n            },\r\n            updateModel(v){\r\n                var field = isArray(this.selectUpdate) ? this.selectUpdate : this.selectUpdate.split(',');\r\n                for (var i=0;i<field.length;i++)\r\n                {\r\n                    var f = field[i];\r\n                    if( f ){\r\n                        var def = /(^[0-9]+$)/.test(this.model[f]) && this.model[f].length<11 ? 0 : '';\r\n                        this.model[f] = v[f] !== undefined ? v[f] : def;\r\n                    }\r\n                }\r\n            },\r\n            getLabel(v){\r\n                var result = '';\r\n                var field = [];\r\n                if(this.showField){\r\n                    field = isArray(this.showField) ? this.showField : this.showField.split(',').filter(v=>!empty(v))\r\n                }else{\r\n                    field = isArray(this.selectUpdate) ? this.selectUpdate : this.selectUpdate.split(',')\r\n                }\r\n\r\n                //var field = isArray(this.selectUpdate) ? this.selectUpdate : this.selectUpdate.split(',')\r\n\r\n                for (var i=0;i<field.length;i++)\r\n                {\r\n                    var f = field[i];\r\n                    if(f && v[f]){\r\n                        result += v[f]+' - ';\r\n                    }\r\n                }\r\n                return result;\r\n            },\r\n            searchTable(isEmit){\r\n                var where = {};\r\n                var field = isArray(this.selectUpdate) ? this.selectUpdate : this.selectUpdate.split(',')\r\n                var ext   = isArray(this.searchUpdate) ? this.searchUpdate : this.searchUpdate.split(',')\r\n                var fs = field.concat(ext).filter(f=>f!='');\r\n                where[fs.join('|')] = [ 'like' , '%'+this.searchMsg.keyword+'%'];\r\n                this.$emit('update-where' , where);\r\n                return new Promise((resolve, reject) => {\r\n                    this.$post(api.search.select , {\r\n                        table:this.module,\r\n                        where:JSON.stringify(where)\r\n                    }).then(res=>{\r\n                        if(isEmit){\r\n                            this.$emit('input' , 0);\r\n                        }\r\n                        this.list = res;\r\n                        resolve(res)\r\n                    }).catch(err=>{\r\n                        reject(err.message);\r\n                    });\r\n                });\r\n            }\r\n        },\r\n        created() {\r\n            this.searchTable().then(res=>{\r\n                if(this.value){\r\n                    this.selectOption(this.value)\r\n                }\r\n            });\r\n        },\r\n        mounted() {\r\n        },\r\n        destroyed() {\r\n        }\r\n    }\r\n</script>\r\n"]}]}