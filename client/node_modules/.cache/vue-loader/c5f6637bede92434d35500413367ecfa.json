{"remainingRequest":"D:\\实训2\\springboot和vue旅游系统蓝色3322\\bysj-client\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\实训2\\springboot和vue旅游系统蓝色3322\\bysj-client\\src\\components\\Tinymce\\index.vue?vue&type=style&index=0&id=0177f75c&lang=scss&scoped=true","dependencies":[{"path":"D:\\实训2\\springboot和vue旅游系统蓝色3322\\bysj-client\\src\\components\\Tinymce\\index.vue","mtime":1619169822000},{"path":"D:\\实训2\\springboot和vue旅游系统蓝色3322\\bysj-client\\node_modules\\css-loader\\dist\\cjs.js","mtime":1755258878741},{"path":"D:\\实训2\\springboot和vue旅游系统蓝色3322\\bysj-client\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":1755258880305},{"path":"D:\\实训2\\springboot和vue旅游系统蓝色3322\\bysj-client\\node_modules\\postcss-loader\\src\\index.js","mtime":1755258879226},{"path":"D:\\实训2\\springboot和vue旅游系统蓝色3322\\bysj-client\\node_modules\\sass-loader\\dist\\cjs.js","mtime":1755258878262},{"path":"D:\\实训2\\springboot和vue旅游系统蓝色3322\\bysj-client\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1755258878262},{"path":"D:\\实训2\\springboot和vue旅游系统蓝色3322\\bysj-client\\node_modules\\vue-loader\\lib\\index.js","mtime":1755258879809}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ci50aW55bWNlLWNvbnRhaW5lciB7CiAgICBwb3NpdGlvbjogcmVsYXRpdmU7CiAgICBsaW5lLWhlaWdodDogbm9ybWFsOwp9CgoudGlueW1jZS1jb250YWluZXIgewogICAgOjp2LWRlZXAgewogICAgICAgIC5tY2UtZnVsbHNjcmVlbiB7CiAgICAgICAgICAgIHotaW5kZXg6IDEwMDAwOwogICAgICAgIH0KICAgIH0KfQoKLnRpbnltY2UtdGV4dGFyZWEgewogICAgdmlzaWJpbGl0eTogaGlkZGVuOwogICAgei1pbmRleDogLTE7Cn0KCi5lZGl0b3ItY3VzdG9tLWJ0bi1jb250YWluZXIgewogICAgcG9zaXRpb246IGFic29sdXRlOwogICAgcmlnaHQ6IDRweDsKICAgIHRvcDogNHB4OwogICAgLyp6LWluZGV4OiAyMDA1OyovCn0KCi5mdWxsc2NyZWVuIC5lZGl0b3ItY3VzdG9tLWJ0bi1jb250YWluZXIgewogICAgei1pbmRleDogMTAwMDA7CiAgICBwb3NpdGlvbjogZml4ZWQ7Cn0KCi5lZGl0b3ItdXBsb2FkLWJ0biB7CiAgICBkaXNwbGF5OiBpbmxpbmUtYmxvY2s7Cn0K"},{"version":3,"sources":["index.vue"],"names":[],"mappings":";AAiQA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA","file":"index.vue","sourceRoot":"src/components/Tinymce","sourcesContent":["<template>\n    <div :class=\"{fullscreen:fullscreen}\" class=\"tinymce-container\" :style=\"{width:containerWidth}\">\n        <textarea :id=\"tinymceId\" class=\"tinymce-textarea\"/>\n        <div class=\"editor-custom-btn-container\">\n            <editorImage color=\"#1890ff\" class=\"editor-upload-btn\" @successCBK=\"imageSuccessCBK\"/>\n        </div>\n    </div>\n</template>\n\n<script>\n    /**\n     * docs:\n     * https://panjiachen.github.io/vue-element-admin-site/feature/component/rich-editor.html#tinymce\n     */\n    import editorImage from './components/EditorImage'\n    import plugins from './plugins'\n    import toolbar from './toolbar'\n    import load from './dynamicLoadScript'\n\n    // why use this cdn, detail see https://github.com/PanJiaChen/tinymce-all-in-one\n    const tinymceCDN = '/static/tinymce/tinymce.min.js'\n\n    export default {\n        name: 'jt-tinymce',\n        components: {editorImage},\n        props: {\n            id: {\n                type: String,\n                default: function () {\n                    return 'vue-tinymce-' + +new Date() + ((Math.random() * 1000).toFixed(0) + '')\n                }\n            },\n            value: {\n                type: String,\n                default: ''\n            },\n            toolbar: {\n                type: Array,\n                required: false,\n                default() {\n                    return []\n                }\n            },\n            menubar: {\n                type: String,\n                default: 'file edit insert view format table'\n            },\n            height: {\n                type: [Number, String],\n                required: false,\n                default: 360\n            },\n            width: {\n                type: [Number, String],\n                required: false,\n                default: 'auto'\n            },\n            uploadImage:{\n                type: Function,\n                required: true\n            },\n            pickerUploadImage:{\n                type: Function,\n                default:function () {\n                    return function (file,success,failure) {\n\n                    }\n                }\n            }\n        },\n        data() {\n            return {\n                hasChange: false,\n                hasInit: false,\n                tinymceId: this.id,\n                fullscreen: false,\n                languageTypeList: {\n                    'en': 'en',\n                    'zh': 'zh_CN',\n                    'es': 'es_MX',\n                    'ja': 'ja'\n                }\n            }\n        },\n        computed: {\n            containerWidth() {\n                const width = this.width\n                if (/^[\\d]+(\\.[\\d]+)?$/.test(width)) { // matches `100`, `'100'`\n                    return `${width}px`\n                }\n                return width\n            }\n        },\n        watch: {\n            value(val) {\n                if (!this.hasChange && this.hasInit) {\n                    this.$nextTick(() =>\n                        window.tinymce.get(this.tinymceId).setContent(val || ''))\n                }\n            }\n        },\n        mounted() {\n            this.init()\n        },\n        activated() {\n            if (window.tinymce) {\n                this.initTinymce()\n            }\n        },\n        deactivated() {\n            this.destroyTinymce()\n        },\n        destroyed() {\n            this.destroyTinymce()\n        },\n        methods: {\n            init() {\n                // dynamic load tinymce from cdn\n                load(tinymceCDN, (err) => {\n                    if (err) {\n                        this.$message.error(err.message)\n                        return\n                    }\n                    this.initTinymce()\n                })\n            },\n            initTinymce() {\n                const _this = this\n                window.tinymce.init({\n                    selector: `#${this.tinymceId}`,\n                    language: this.languageTypeList['zh'],\n                    height: this.height,\n                    body_class: 'panel-body ',\n                    object_resizing: false,\n                    paste_data_images:true,\n                    toolbar: this.toolbar.length > 0 ? this.toolbar : toolbar,\n                    menubar: this.menubar,\n                    plugins: plugins,\n                    end_container_on_empty_block: true,\n                    powerpaste_word_import: 'clean',\n                    code_dialog_height: 450,\n                    code_dialog_width: 1000,\n                    branding:false,\n                    automatic_uploads: true,\n                    advlist_bullet_styles: 'square',\n                    advlist_number_styles: 'default',\n                    imagetools_cors_hosts: ['www.tinymce.com', 'codepen.io'],\n                    default_link_target: '_blank',\n                    link_title: false,\n                    nonbreaking_force_tab: true, // inserting nonbreaking space &nbsp; need Nonbreaking Space Plugin\n                    init_instance_callback: editor => {\n                        if (_this.value) {\n                            editor.setContent(_this.value)\n                        }\n                        _this.hasInit = true\n                        editor.on('NodeChange Change KeyUp SetContent', () => {\n                            this.hasChange = true\n                            this.$emit('input', editor.getContent())\n                        })\n                    },\n                    setup(editor) {\n                        editor.on('FullscreenStateChanged', (e) => {\n                            _this.fullscreen = e.state\n                        })\n                    },\n                    // it will try to keep these URLs intact\n                    // https://www.tiny.cloud/docs-3x/reference/configuration/Configuration3x@convert_urls/\n                    // https://stackoverflow.com/questions/5196205/disable-tinymce-absolute-to-relative-url-conversions\n                    convert_urls: false,\n                    images_upload_handler(blobInfo, success, failure){\n                        _this.uploadImage(blobInfo.blob() , success , failure)\n                    },\n\n                    //拖放方式 上传图片\n                    file_picker_callback: function (callback, value, meta) {\n\n                        var input = document.createElement('input');\n                        input.setAttribute('type', 'file');\n\n                        input.onchange = function () {\n\n                            var file = this.files[0];\n                            if(file){\n                                _this.uploadImage(file , callback , function () {\n\n                                })\n                            }\n\n                            /*_this.pickerUploadImage(file, callback , function () {\n\n                            })*/\n                        };\n                        input.click();\n                    },\n                    paste_upload_image:function (editor , file , success , error) {\n                        _this.uploadImage(file , success , error)\n                    }\n                })\n            },\n            destroyTinymce() {\n                const tinymce = window.tinymce.get(this.tinymceId)\n                if (this.fullscreen) {\n                    tinymce.execCommand('mceFullScreen')\n                }\n                if (tinymce) {\n                    tinymce.destroy()\n                }\n            },\n            setContent(value) {\n                window.tinymce.get(this.tinymceId).setContent(value)\n            },\n            getContent() {\n                window.tinymce.get(this.tinymceId).getContent()\n            },\n            imageSuccessCBK(arr) {\n                arr.forEach(v => window.tinymce.get(this.tinymceId).insertContent(`<img class=\"wscnph\" src=\"${v.url}\" >`))\n            }\n        }\n    }\n</script>\n\n<style lang=\"scss\" scoped>\n    .tinymce-container {\n        position: relative;\n        line-height: normal;\n    }\n\n    .tinymce-container {\n        ::v-deep {\n            .mce-fullscreen {\n                z-index: 10000;\n            }\n        }\n    }\n\n    .tinymce-textarea {\n        visibility: hidden;\n        z-index: -1;\n    }\n\n    .editor-custom-btn-container {\n        position: absolute;\n        right: 4px;\n        top: 4px;\n        /*z-index: 2005;*/\n    }\n\n    .fullscreen .editor-custom-btn-container {\n        z-index: 10000;\n        position: fixed;\n    }\n\n    .editor-upload-btn {\n        display: inline-block;\n    }\n</style>\n"]}]}