{"remainingRequest":"D:\\实训2\\springboot和vue旅游系统蓝色3322\\bysj-client\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\实训2\\springboot和vue旅游系统蓝色3322\\bysj-client\\src\\components\\image\\upload-images.vue?vue&type=script&lang=js","dependencies":[{"path":"D:\\实训2\\springboot和vue旅游系统蓝色3322\\bysj-client\\src\\components\\image\\upload-images.vue","mtime":1619169822000},{"path":"D:\\实训2\\springboot和vue旅游系统蓝色3322\\bysj-client\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1755258878262},{"path":"D:\\实训2\\springboot和vue旅游系统蓝色3322\\bysj-client\\node_modules\\babel-loader\\lib\\index.js","mtime":1755258879229},{"path":"D:\\实训2\\springboot和vue旅游系统蓝色3322\\bysj-client\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1755258878262},{"path":"D:\\实训2\\springboot和vue旅游系统蓝色3322\\bysj-client\\node_modules\\vue-loader\\lib\\index.js","mtime":1755258879809}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:DQogICAgaW1wb3J0IHtpc0FycmF5fSBmcm9tICJAL3V0aWxzL2V4dGVuZCI7DQogICAgaW1wb3J0IGFwaSBmcm9tICJAL2FwaSI7DQogICAgaW1wb3J0IEVJbWcgZnJvbSAiQC9jb21wb25lbnRzL2ltYWdlL2ltZyI7DQogICAgaW1wb3J0IHtmb3JtYXRJbWFnZVNyY30gZnJvbSAiQC91dGlscy91dGlscyI7DQogICAgaW1wb3J0IGRyYWdnYWJsZSBmcm9tICd2dWVkcmFnZ2FibGUnDQogICAgY29uc3QgcGF0aCA9IHJlcXVpcmUoJ3BhdGgnKQ0KDQogICAgZXhwb3J0IGRlZmF1bHQgew0KICAgICAgICBuYW1lOiAiZS11cGxvYWQtaW1hZ2VzIiwNCiAgICAgICAgY29tcG9uZW50czoge0VJbWcsZHJhZ2dhYmxlfSwNCiAgICAgICAgZGF0YSgpIHsNCiAgICAgICAgICAgIHJldHVybiB7DQogICAgICAgICAgICAgICAgZHJhZ09wdGlvbnM6ew0KDQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICBpc0RyYWdnaW5nOmZhbHNlLA0KICAgICAgICAgICAgICAgIGRpYWxvZ1Zpc2libGU6ZmFsc2UsDQogICAgICAgICAgICAgICAgZGlhbG9nSW1hZ2VVcmw6JycsDQogICAgICAgICAgICAgICAgbG9hZGluZzogZmFsc2UNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSwNCiAgICAgICAgcHJvcHM6IHsNCiAgICAgICAgICAgIHZhbHVlOiBbU3RyaW5nLCBBcnJheV0NCiAgICAgICAgfSwNCiAgICAgICAgY29tcHV0ZWQ6ew0KICAgICAgICAgICAgZmlsZUxpc3Q6ew0KICAgICAgICAgICAgICAgIGdldCgpew0KICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5pbWFnZXNVcmwoKTsNCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgIHNldCh2YWwpew0KICAgICAgICAgICAgICAgICAgICB0aGlzLiRlbWl0KCdpbnB1dCcgLCB2YWwuam9pbignLCcpKQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgfSwNCiAgICAgICAgd2F0Y2g6IHt9LA0KICAgICAgICBtZXRob2RzOiB7DQogICAgICAgICAgICBQcmV2aWV3KGZpbGUpew0KICAgICAgICAgICAgICAgIHRoaXMuZGlhbG9nSW1hZ2VVcmwgPSBmaWxlOw0KICAgICAgICAgICAgICAgIHRoaXMuZGlhbG9nVmlzaWJsZSA9IHRydWU7DQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgZG93bmxvYWQoZmlsZSl7DQogICAgICAgICAgICAgICAgdmFyIGEgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdhJyk7DQogICAgICAgICAgICAgICAgYS5ocmVmID0gZm9ybWF0SW1hZ2VTcmMoZmlsZSk7DQogICAgICAgICAgICAgICAgYS5zZXRBdHRyaWJ1dGUoImRvd25sb2FkIiAsIHBhdGguYmFzZW5hbWUoZmlsZSkpOw0KICAgICAgICAgICAgICAgIGEudGFyZ2V0ID0gJ19ibGFuaycNCiAgICAgICAgICAgICAgICBhLmNsaWNrKCk7DQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgZGVsZXRlSW1hZ2UoIGZpbGUgKXsNCiAgICAgICAgICAgICAgICB2YXIgaW1hZ2VzID0gdGhpcy5pbWFnZXNVcmwoKS5maWx0ZXIoIGY9PmYhPWZpbGUgKQ0KICAgICAgICAgICAgICAgIHRoaXMuJGVtaXQoJ2lucHV0JyAsIGltYWdlcy5qb2luKCcsJykpDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgaW1hZ2VzVXJsKCkgew0KICAgICAgICAgICAgICAgIHZhciBpbWFnZXMgPSB0aGlzLnZhbHVlOw0KICAgICAgICAgICAgICAgIGlmICghaXNBcnJheShpbWFnZXMpKSB7DQogICAgICAgICAgICAgICAgICAgIGltYWdlcyA9IGltYWdlcy5zcGxpdCgiLCIpOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICByZXR1cm4gaW1hZ2VzLmZpbHRlcihzID0+IHMgIT0gJycpOw0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgIGJlZm9yZVVwbG9hZChmaWxlKSB7DQoNCiAgICAgICAgICAgICAgICB0aGlzLmxvYWRpbmcgPSB0cnVlOw0KICAgICAgICAgICAgICAgIGFwaS5hdHRhY2htZW50LnVwbG9hZChmaWxlKS50aGVuKGYgPT4gew0KICAgICAgICAgICAgICAgICAgICB0aGlzLmxvYWRpbmcgPSBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGltYWdlcyA9IHRoaXMuaW1hZ2VzVXJsKCk7DQogICAgICAgICAgICAgICAgICAgIGltYWdlcy5wdXNoKGYpOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLiRlbWl0KCdpbnB1dCcsIGltYWdlcy5qb2luKCcsJykpOw0KICAgICAgICAgICAgICAgIH0pLmNhdGNoKGVyciA9PiB7DQogICAgICAgICAgICAgICAgICAgIHRoaXMubG9hZGluZyA9IGZhbHNlOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLiRtZXNzYWdlLmVycm9yKGVycik7DQogICAgICAgICAgICAgICAgfSkNCiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICAgICAgICB9DQogICAgICAgIH0sDQogICAgICAgIGNyZWF0ZWQoKSB7DQoNCiAgICAgICAgfSwNCiAgICAgICAgbW91bnRlZCgpIHsNCiAgICAgICAgfSwNCiAgICAgICAgZGVzdHJveWVkKCkgew0KICAgICAgICB9DQogICAgfQ0K"},{"version":3,"sources":["upload-images.vue"],"names":[],"mappings":";AA0CA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA","file":"upload-images.vue","sourceRoot":"src/components/image","sourcesContent":["<template>\r\n    <div class=\"e-upload-images\" v-loading=\"loading\">\r\n        <el-upload list-type=\"picture-card\" :show-file-list=\"false\" action=\"#\" multiple :before-upload=\"beforeUpload\">\r\n            <i slot=\"trigger\" class=\"el-icon-plus\"></i>\r\n            <draggable class=\"el-upload-list el-upload-list--picture-card\" element=\"ul\" v-model=\"fileList\" :options=\"dragOptions\" @start=\"isDragging=true\" @end=\"isDragging=false\">\r\n                <li tabindex=\"0\" class=\"el-upload-list__item is-ready\" v-for=\"img in imagesUrl()\" :key=\"img\">\r\n                    <div>\r\n                        <e-img :src=\"img\" alt=\"\" class=\"el-upload-list__item-thumbnail\" />\r\n                        <div class=\"el-upload-list__item-actions\">\r\n                            <span class=\"el-upload-list__item-preview\" @click=\"Preview(img)\"><i class=\"el-icon-zoom-in\"></i></span>\r\n                            <span class=\"el-upload-list__item-delete\" @click=\"download(img)\"><i class=\"el-icon-download\"></i></span>\r\n                            <el-popconfirm title=\"确定删除该图片？\" @confirm=\"deleteImage(img)\" @onConfirm=\"deleteImage(img)\">\r\n                            <span class=\"el-upload-list__item-delete\" slot=\"reference\"><i class=\"el-icon-delete\"></i></span>\r\n                            </el-popconfirm>\r\n                        </div>\r\n                    </div>\r\n                </li>\r\n            </draggable>\r\n        </el-upload>\r\n        <el-dialog :visible.sync=\"dialogVisible\">\r\n            <e-img width=\"100%\" :src=\"dialogImageUrl\" alt=\"\"/>\r\n        </el-dialog>\r\n    </div>\r\n</template>\r\n<style type=\"text/scss\" scoped lang=\"scss\">\r\n    .e-upload-images {\r\n        .el-upload-list{\r\n            margin-left: 10px;\r\n        }\r\n        .el-upload {\r\n            margin-right: 20px;\r\n            margin-bottom: 20px;\r\n            text-align: center;\r\n\r\n            img {\r\n                max-width: 100%;\r\n                max-height: 100%;\r\n            }\r\n        }\r\n    }\r\n</style>\r\n<script>\r\n    import {isArray} from \"@/utils/extend\";\r\n    import api from \"@/api\";\r\n    import EImg from \"@/components/image/img\";\r\n    import {formatImageSrc} from \"@/utils/utils\";\r\n    import draggable from 'vuedraggable'\r\n    const path = require('path')\r\n\r\n    export default {\r\n        name: \"e-upload-images\",\r\n        components: {EImg,draggable},\r\n        data() {\r\n            return {\r\n                dragOptions:{\r\n\r\n                },\r\n                isDragging:false,\r\n                dialogVisible:false,\r\n                dialogImageUrl:'',\r\n                loading: false\r\n            }\r\n        },\r\n        props: {\r\n            value: [String, Array]\r\n        },\r\n        computed:{\r\n            fileList:{\r\n                get(){\r\n                    return this.imagesUrl();\r\n                },\r\n                set(val){\r\n                    this.$emit('input' , val.join(','))\r\n                }\r\n            }\r\n        },\r\n        watch: {},\r\n        methods: {\r\n            Preview(file){\r\n                this.dialogImageUrl = file;\r\n                this.dialogVisible = true;\r\n            },\r\n            download(file){\r\n                var a = document.createElement('a');\r\n                a.href = formatImageSrc(file);\r\n                a.setAttribute(\"download\" , path.basename(file));\r\n                a.target = '_blank'\r\n                a.click();\r\n            },\r\n            deleteImage( file ){\r\n                var images = this.imagesUrl().filter( f=>f!=file )\r\n                this.$emit('input' , images.join(','))\r\n            },\r\n            imagesUrl() {\r\n                var images = this.value;\r\n                if (!isArray(images)) {\r\n                    images = images.split(\",\");\r\n                }\r\n                return images.filter(s => s != '');\r\n            },\r\n            beforeUpload(file) {\r\n\r\n                this.loading = true;\r\n                api.attachment.upload(file).then(f => {\r\n                    this.loading = false;\r\n                    var images = this.imagesUrl();\r\n                    images.push(f);\r\n                    this.$emit('input', images.join(','));\r\n                }).catch(err => {\r\n                    this.loading = false;\r\n                    this.$message.error(err);\r\n                })\r\n                return false;\r\n            }\r\n        },\r\n        created() {\r\n\r\n        },\r\n        mounted() {\r\n        },\r\n        destroyed() {\r\n        }\r\n    }\r\n</script>\r\n"]}]}